import pandas as pd
from openpyxl import load_workbook

wb = load_workbook("file.xlsx", data_only=True)
ws = wb.active

data = []
for row in ws.iter_rows():
    row_values = []
    row_colors = []
    for cell in row:
        # value
        row_values.append(cell.value)

        # color (fgColor = fill color)
        color = cell.fill.fgColor.rgb
        if color == "00000000":  # default = no color
            color = None
        row_colors.append(color)

    data.append((row_values, row_colors))

# Convert to dataframe (merge value + color)
value_df = pd.DataFrame([v for v, c in data])
color_df = pd.DataFrame([c for v, c in data])

# Rename columns
value_df.columns = [f"col{i}_value" for i in range(value_df.shape[1])]
color_df.columns = [f"col{i}_color" for i in range(color_df.shape[1])]

df = pd.concat([value_df, color_df], axis=1)

print(df)
